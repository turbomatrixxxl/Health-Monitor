"use strict";(self.webpackChunkhealth_monitor=self.webpackChunkhealth_monitor||[]).push([[721],{8772:(e,t,o)=>{function s(e){let t;t=e<14?[9,11]:e<=17?[8,10]:e<=64?[7,9]:[7,8],"high"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"moderate")&&(t=[t[0]+.5,t[1]+1]);const o=t[0];return(t[1]+o)/2}o.d(t,{A:()=>s})},20379:(e,t,o)=>{function s(e,t,o,s,n,a){const i=Number(String(e).trim()),l=Number(String(t).trim()),r=Number(String(s).trim()),d=Number(String(n).trim()),c=String(o||"").trim().toUpperCase(),u=String(a||"").trim().toUpperCase();if([i,l,r,d].some(Number.isNaN))return 0;let p=i%12;"PM"===c&&(p+=12);let m=r%12;"PM"===u&&(m+=12);let h=60*m+d-(60*p+l);h<0&&(h+=1440);return parseFloat((h/60).toFixed(1))}o.d(t,{A:()=>s})},25480:(e,t,o)=>{function s(e,t){if(!e)return 0;const o=Math.round(70+.3*(e-30)),s=Math.round(o-10),n=Math.round(o+10),a=Math.round(110+.5*e),i=Math.round(a-10),l=Math.round(a+10),r=Math.round(70+.2*e);let d=o,c=s,u=n,p=a,m=i,h=l,x=r,v=Math.round(r-5),g=Math.round(r+5);return t&&(t>80?(d+=2,c+=2,u+=2,p+=3,m+=3,h+=3,x+=2,v+=2,g+=2):t<60&&(d-=2,c-=2,u-=2,p-=3,m-=3,h-=3,x-=2,v-=2,g-=2)),{heartRate:d,heartRateMin:c,heartRateMax:u,systolic:p,systolicMin:m,systolicMax:h,diastolic:x,diastolicMin:v,diastolicMax:g}}o.d(t,{A:()=>s})},29686:(e,t,o)=>{function s(e,t,o,s){let n;n=e<30?1.2:e<50?1.1:1;let a,i=6e3+20*(s-150),l=o-t;a=0===l?0:l<0?200*Math.abs(l):150*-l;let r=e&&t&&o&s?Math.round((i+a)*n):0;return r<4e3&&(r=4e3),r>15e3&&(r=15e3),r}o.d(t,{A:()=>s})},32721:(e,t,o)=>{o.r(t),o.d(t,{default:()=>R});var s=o(89379),n=o(65043);const a={cont:"ExportReportsPage_cont__koYLr",leftSideCont:"ExportReportsPage_leftSideCont__qCae-",rightSideCont:"ExportReportsPage_rightSideCont__91oX2",title:"ExportReportsPage_title__-wWhT",datesCont:"ExportReportsPage_datesCont__jhSa3",dateCont:"ExportReportsPage_dateCont__V5bD2",date:"ExportReportsPage_date__Nausv",generateBtn:"ExportReportsPage_generateBtn__QUQ5d",rightSideContList:"ExportReportsPage_rightSideContList__jim4J",rightSideContListItem:"ExportReportsPage_rightSideContListItem__H42Vb",rightSideContListItemLeftCont:"ExportReportsPage_rightSideContListItemLeftCont__A6IMK",btnsCont:"ExportReportsPage_btnsCont__CknZe",openReportModalBtn:"ExportReportsPage_openReportModalBtn__PuZNn",rightSideContListItemDatesCont:"ExportReportsPage_rightSideContListItemDatesCont__f1NFj",downloadBtn:"ExportReportsPage_downloadBtn__43Jze",deleteBtn:"ExportReportsPage_deleteBtn__vSrsu",empty:"ExportReportsPage_empty__tASKy"};var i=o(19095),l=o(58387),r=o(29686),d=o(8772),c=o(73216),u=o(25480);var p=o(20379),m=o(72952),h=o(6396),x=o(64857);function v(e){const t=new h.Ay;t.setFontSize(16),t.text("Health Report for ".concat(e.name),14,20),t.setFontSize(12);const o=e.from===e.till?"Date: ".concat(new Date(e.from).toDateString()):"Period: ".concat(new Date(e.from).toDateString()," - ").concat(new Date(e.till).toDateString());t.text(o,14,30);let s=40;if(t.text("Based on your personal info, your daily recommended values are:",14,s),s+=8,t.text("Calories: ".concat(e.caloriesRecommended),14,s),s+=6,t.text("Steps: ".concat(e.stepsRecommended),14,s),s+=6,t.text("Sleep: ".concat(e.sleepRecommended,"h"),14,s),s+=6,t.text("Pulse: ".concat(e.pulseRecommended," (Range: ").concat(e.heartRateMin," - ").concat(e.heartRateMax,")"),14,s),s+=6,t.text("Blood Pressure: ".concat(e.systolicRecommended,"/").concat(e.diastolicRecommended," (Sys ").concat(e.systolicMin,"-").concat(e.systolicMax,", Dia ").concat(e.diastolicMin,"-").concat(e.diastolicMax,")"),14,s),s+=12,!e.dates||0===e.dates.length)return t.setTextColor(200,0,0),t.text("No records for this period",14,s),t;const n=e.dates.map(t=>{const o=new Date(t.date).toDateString();let s="No records";t.calories>0&&(s=t.calories<.6*e.caloriesRecommended||t.calories>e.caloriesRecommended?"".concat(t.calories," (!)"):"".concat(t.calories," (OK)"));let n="No records";t.steps>0&&(n=t.steps<.6*e.stepsRecommended?"".concat(t.steps," (!)"):"".concat(t.steps," (OK)"));let a="No records";if(t.sleep>0){const o=Number(t.sleep.toFixed(1));a=o<.6*e.sleepRecommended||o>e.sleepRecommended+1?"".concat(o,"h (!)"):"".concat(o,"h (OK)")}return[o,s,n,a,t.pulse?String(t.pulse):"-",t.systolic&&t.diastolic?"".concat(t.systolic,"/").concat(t.diastolic):"-"]});return(0,x.Ay)(t,{head:[["Date","Calories","Steps","Sleep (h)","Pulse","Blood Pressure"]],body:n,startY:s,styles:{fontSize:10},didParseCell:e=>{if("body"===e.section){const t=String(e.cell.text[0]);t.includes("(!)")?e.cell.styles.textColor=[200,0,0]:t.includes("(OK)")?e.cell.styles.textColor=[0,150,0]:"No records"===t&&(e.cell.styles.textColor=[200,0,0])}}}),t}const g={overlay:"ReportModal_overlay__T2pPa",modal:"ReportModal_modal__EH9QH",downloadBtn:"ReportModal_downloadBtn__x+InD",closeBtn:"ReportModal_closeBtn__4nhEo"};var _=o(70579);function f(e){let{report:t,onClose:o}=e;const[s,a]=(0,n.useState)(""),i=e=>new Date(e).toDateString();(0,n.useEffect)(()=>{if(t){const e=v(t).output("blob"),o=URL.createObjectURL(e);a(o)}},[t]);return t?(0,_.jsx)("div",{className:g.overlay,children:(0,_.jsxs)("div",{className:g.modal,children:[(0,_.jsx)("h2",{children:"PDF Preview"}),s&&(0,_.jsx)("iframe",{src:s,title:"PDF Preview",width:"100%",height:"400px",style:{border:"1px solid #ccc"}}),(0,_.jsxs)("div",{className:g.buttons,children:[(0,_.jsx)("button",{onClick:()=>{const e=v(t),o="".concat(t.name,"_Health_Report-").concat(i(t.from)).concat(t.from!==t.till?"-"+i(t.till):"",".pdf");e.save(o)},className:g.downloadBtn,children:"Download"}),(0,_.jsx)("button",{onClick:o,className:g.closeBtn,children:"Close"})]})]})}):null}const R=function(){var e;const t=(0,c.Zp)(),{user:o,privateDispatch:h}=(0,i.d)();console.log("user exports:",o);const x=(null===o||void 0===o?void 0:o.username)||(null===o||void 0===o?void 0:o.name)||"User",g=(null===o||void 0===o?void 0:o.age)||0,R=(null===o||void 0===o?void 0:o.height)||0,C=(null===o||void 0===o?void 0:o.weight)||0,y=(null===o||void 0===o?void 0:o.desiredWeight)||0,S=(null===o||void 0===o?void 0:o.bloodType)||0,M=g>0||R>0||C>0||y>0||S>0,N=null===o||void 0===o||null===(e=o.dietaryInfo)||void 0===e?void 0:e.dailyCalorieIntake,b=(0,r.A)(g,C,y,R),j=(0,d.A)(g),D=(0,u.A)(g,C),{heartRate:P,systolic:w,diastolic:E,heartRateMin:B,heartRateMax:A,systolicMin:L,systolicMax:I,diastolicMin:k,diastolicMax:H}=D,F=e=>new Date(e).toISOString().split("T")[0],T=(0,n.useMemo)(()=>(null===o||void 0===o?void 0:o.reports)||[],[null===o||void 0===o?void 0:o.reports]),[O,K]=(0,n.useState)([]);(0,n.useEffect)(()=>{const e=[...T].sort((e,t)=>new Date(t.from)-new Date(e.from));K([...e])},[K,T]);const U=new Date,z=F(U),[G,Z]=(0,n.useState)(z),[Q,W]=(0,n.useState)(z),[Y,J]=(0,n.useState)({from:G,till:Q,name:x,age:g,height:R,weight:C,desiredWeight:y,bloodType:S,caloriesRecommended:N,stepsRecommended:b,sleepRecommended:j,systolicRecommended:w,diastolicRecommended:E,pulseRecommended:P,heartRateMin:B,heartRateMax:A,systolicMin:L,systolicMax:I,diastolicMin:k,diastolicMax:H,dates:[]});(0,n.useEffect)(()=>{J(e=>(0,s.A)((0,s.A)({},e),{},{from:G,till:Q}))},[G,Q]);const V=(0,n.useMemo)(()=>function(e,t){const o=[],s=e=>new Date(e).toISOString().split("T")[0],n=new Date(e);n.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const i=a-n,l=Math.ceil(i/864e5);for(let r=1;r<=l+1;r++){const e=new Date(n);e.setDate(n.getDate()+r),o.push(s(e))}return o}(G,Q),[G,Q]);(0,n.useEffect)(()=>{if(!o)return;const e=V.map(e=>{var t,s;const n=((null===o||void 0===o?void 0:o.consumedProducts)||[]).filter(t=>F(null===t||void 0===t?void 0:t.date)===F(e)),a=n.reduce((e,t)=>0===n.length?0:e+=t.calories,0),i=((null===o||void 0===o?void 0:o.steps)||[]).find(t=>F(t.date)===F(e)),l=i?null===i||void 0===i||null===(t=i.interval)||void 0===t?void 0:t.reduce((e,t)=>e+=t.steps,0):0,r=((null===o||void 0===o?void 0:o.sleep)||[]).find(t=>F(t.date)===F(e)),d=r?null===(s=r.interval)||void 0===s?void 0:s.reduce((e,t)=>e+=(0,p.A)(t.fromHour,t.fromMinute,t.fromAmPm,t.tillHour,t.tillMinute,t.tillAmPm),0):0,c=((null===o||void 0===o?void 0:o.heart)||[]).find(t=>F(t.date)===F(e)),u=c?{pulse:null===c||void 0===c?void 0:c.pulse,systolic:null===c||void 0===c?void 0:c.systolic,diastolic:null===c||void 0===c?void 0:c.diastolic}:0;return a>0||l>0||d>0||u>0?{date:e,calories:a,steps:l,sleep:d,systolic:u.systolic||0,diastolic:u.diastolic||0,pulse:u.pulse||0}:null}).filter(e=>null!==e);J(t=>(0,s.A)((0,s.A)({},t),{},{dates:e}))},[V,o]);const q=e=>new Date(e).toDateString(),[X,$]=(0,n.useState)(null);return(0,_.jsxs)("div",{className:a.cont,children:[(0,_.jsxs)("div",{className:a.leftSideCont,children:[(0,_.jsx)("h1",{className:a.title,children:"Exports & Reports"}),(0,_.jsxs)("div",{className:a.datesCont,children:[(0,_.jsxs)("div",{className:a.dateCont,children:[(0,_.jsx)("p",{className:a.dateTitle,children:"Start date"}),(0,_.jsx)("input",{onChange:e=>Z(e.target.value),value:G,className:a.date,max:z,type:"date"})]}),(0,_.jsxs)("div",{className:a.dateCont,children:[(0,_.jsx)("p",{className:a.dateTitle,children:"End date"}),(0,_.jsx)("input",{onChange:e=>W(e.target.value),value:Q,className:a.date,min:G,max:z,type:"date"})]})]}),M?(0,_.jsx)("button",{onClick:function(){h((0,m.dL)({report:(0,s.A)({},Y)})),Z(z),W(z)},className:a.generateBtn,type:"button",children:"Generate report"}):(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",background:"aliceblue",border:"1px solid var(--Gray-5)",borderRadius:"5px",padding:"10px"},children:[(0,_.jsx)("p",{style:{display:"flex",textAlign:"center",color:"red"},children:"It seems that you did not set up your personal info. Please Go:"}),(0,_.jsx)("button",{onClick:()=>t("/"),className:a.generateBtn,type:"button",children:"Diet Calculator"})]})]}),(0,_.jsxs)("div",{className:a.rightSideCont,children:[(0,_.jsx)("h1",{className:a.title,children:"Generated Reports..."}),(0,_.jsx)("ul",{className:a.rightSideContList,children:O.length>0?O.map(e=>(0,_.jsxs)("li",{className:a.rightSideContListItem,children:[(0,_.jsxs)("div",{className:a.rightSideContListItemLeftCont,children:[(0,_.jsxs)("div",{className:a.btnsCont,children:[(0,_.jsx)("button",{onClick:()=>(e=>{$(e)})(e),type:"button",className:a.openReportModalBtn,children:"PDF Report"}),(0,_.jsx)("button",{onClick:()=>{return t=e._id,void h((0,m.Z5)({id:t}));var t},type:"button",className:(0,l.A)(a.openReportModalBtn,a.deleteBtn),children:"Delete"})]}),(0,_.jsxs)("div",{className:a.rightSideContListItemDatesCont,children:[(0,_.jsx)("span",{children:q(e.from)}),e.from!==e.till&&(0,_.jsxs)("span",{children:["-",q(e.till)]})]})]}),(0,_.jsx)("button",{onClick:()=>(e=>{const t=v(e),o="".concat(e.name,"_Health_Report-").concat(q(e.from)).concat(e.from!==e.till?"-"+q(e.till):"",".pdf");t.save(o)})(e),type:"button",className:a.downloadBtn,children:"Download"})]},"report-".concat(e._id))):(0,_.jsx)("li",{className:(0,l.A)(a.rightSideContListItem,a.empty),children:"No Reports Yet"})}),X&&(0,_.jsx)(f,{report:X,onClose:()=>{$(null)}})]})]})}}}]);
//# sourceMappingURL=721.20421200.chunk.js.map