"use strict";(self.webpackChunkhealth_monitor=self.webpackChunkhealth_monitor||[]).push([[521],{1695:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var a=n(9379),r=n(5043),s=n(9095),i=n(2952),l=n(5475);var c=n(5582),d=n(3797),o=n.n(d);const u="AlertForm_formModalCont__n1AHS",m="AlertForm_form__WOPSZ",_="AlertForm_close__6XhrF",h="AlertForm_inputGroup__C-9ve",y="AlertForm_weekly__FbPlI",p="AlertForm_checkboxLabel__V4eiP",f="AlertForm_smallBtn__YJ5YK",x="AlertForm_buttonGroup__C9g8J",g="AlertForm_saveBtn__nemPP",v="AlertForm_cancelBtn__+GW3d";var A=n(579);const j=["Mo","Tu","We","Th","Fr","Sa","Su"],b=new Date,N="".concat(b.getFullYear(),"-").concat(String(b.getMonth()+1).padStart(2,"0"),"-").concat(String(b.getDate()).padStart(2,"0"));function q(e){let{onClose:t,handleSubmit:n,data:s,editId:i}=e;const l=(0,r.useRef)(),[c,d]=(0,r.useState)(()=>"daily"===s.frequency?"daily":"string"===typeof s.frequency&&s.frequency.includes("monthly")?"monthly":"string"===typeof s.frequency&&/^\d{4}-\d{2}-\d{2}$/.test(s.frequency)?"date":(Array.isArray(s.frequency),"weekly")),[o,b]=(0,r.useState)(Array.isArray(s.frequency)?[...s.frequency]:[]),[q,D]=(0,r.useState)((0,a.A)((0,a.A)({},s),{},{frequency:s.frequency})),[S,C]=(0,r.useState)(N);(0,r.useEffect)(()=>{document.body.style.overflow="hidden";const e=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",e),()=>{document.body.style.overflow="auto",document.removeEventListener("keydown",e)}},[t]),(0,r.useEffect)(()=>{Array.isArray(s.frequency)&&b([...s.frequency])},[s.frequency]);const k=(e,t)=>{D(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t}))},P="alert"===q.type||"metrix"===q.type;return(0,A.jsx)("div",{ref:l,onClick:e=>{e.currentTarget===e.target&&t()},className:u,children:(0,A.jsxs)("form",{className:m,onSubmit:e=>{let t;e.preventDefault(),t="daily"===c?"daily":"weekly"===c?o:"monthly"===c?q.frequency:"date"===c?S:q.frequency;const r=(0,a.A)((0,a.A)({},q),{},{frequency:t});n(r)},children:[(0,A.jsx)("button",{className:_,onClick:t,type:"button",children:"x"}),P&&(0,A.jsxs)("div",{className:h,children:[(0,A.jsx)("label",{children:"Reminder Text"}),(0,A.jsx)("input",{type:"text",placeholder:"Enter reminder",value:q.text,onChange:e=>k("text",e.target.value),required:!0})]}),(0,A.jsxs)("div",{className:h,children:[(0,A.jsx)("label",{children:"Time"}),(0,A.jsx)("input",{type:"time",value:q.time,onChange:e=>k("time",e.target.value),required:!0})]}),P&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{className:h,children:[(0,A.jsx)("label",{children:"Frequency"}),(0,A.jsxs)("select",{value:c,onChange:e=>{d(e.target.value),"daily"===e.target.value&&k("frequency","daily"),"weekly"===e.target.value&&k("frequency",[])},children:[(0,A.jsx)("option",{value:"daily",children:"Daily"}),(0,A.jsx)("option",{value:"weekly",children:"Weekly (choose days)"}),(0,A.jsx)("option",{value:"monthly",children:"Monthly (choose day)"}),(0,A.jsx)("option",{value:"date",children:"Specific Date"})]})]}),"weekly"===c&&(0,A.jsxs)("div",{className:y,children:[j.map(e=>(0,A.jsxs)("label",{className:p,children:[(0,A.jsx)("input",{type:"checkbox",checked:o.includes(e),onChange:()=>(e=>{let t=o.includes(e)?o.filter(t=>t!==e):[...o,e];7===t.length?(d("daily"),b([]),k("frequency","daily")):(b(t),k("frequency",t))})(e)}),e]},e)),(0,A.jsx)("button",{type:"button",className:f,onClick:()=>{d("daily"),b([]),k("frequency","daily")},children:"All"})]}),"monthly"===c&&(0,A.jsxs)("div",{className:h,children:[(0,A.jsx)("label",{children:"Day of Month"}),(0,A.jsx)("input",{type:"number",min:1,max:31,step:1,value:parseInt(q.frequency)||"",onChange:e=>{return t=parseInt(e.target.value),k("frequency","".concat(t," monthly"));var t}})]}),"date"===c&&(0,A.jsxs)("div",{className:h,children:[(0,A.jsx)("label",{children:"Specific Date"}),(0,A.jsx)("input",{style:{color:"blue",fontWeight:"bold"},type:"date",min:N,value:/^\d{4}-\d{2}-\d{2}$/.test(q.frequency)?q.frequency:S,onChange:e=>{var t;t=e.target.value,k("frequency",t),C(e.target.value)}})]})]}),(0,A.jsxs)("div",{className:h,children:[(0,A.jsx)("label",{children:"Repeat Interval (hours)"}),(0,A.jsx)("input",{type:"number",min:1,max:12,step:1,value:parseInt(q.repeat)>0?parseInt(q.repeat):"noRepeat",onChange:e=>{const t=parseInt(e.target.value);k("repeat",isNaN(t)||t<=0?"noRepeat":1===t?"1 hour":"".concat(t," hours"))},placeholder:"No Repeat"})]}),(0,A.jsxs)("div",{className:x,children:[(0,A.jsx)("button",{type:"submit",className:g,children:i?"Update Reminder":"Add Reminder"}),(0,A.jsx)("button",{type:"button",onClick:t,className:v,children:"Cancel"})]})]})})}var D=n(8387);const S={cont:"AlertsPage_cont__Bn-of",leftSideCont:"AlertsPage_leftSideCont__uvpyK",rightSideCont:"AlertsPage_rightSideCont__HCF89",title:"AlertsPage_title__vqj0-",rightSideTitle:"AlertsPage_rightSideTitle__uQTtz",headerBox:"AlertsPage_headerBox__3iOMH",addBtn:"AlertsPage_addBtn__b3wO3",main:"AlertsPage_main__KHw-R",calendarBox:"AlertsPage_calendarBox__iSP3z",calendar:"AlertsPage_calendar__vOV+q","rbc-today":"AlertsPage_rbc-today__P2l6q","rbc-time-slot":"AlertsPage_rbc-time-slot__k-Hoo","rbc-event":"AlertsPage_rbc-event__7F-kq",remindersList:"AlertsPage_remindersList__BaT+d",reminderItem:"AlertsPage_reminderItem__bQ515",closeBtn:"AlertsPage_closeBtn__p7Nz7",reminderItemDetailsCont:"AlertsPage_reminderItemDetailsCont__cSW7q",actions:"AlertsPage_actions__ExvCf",insideActions:"AlertsPage_insideActions__J7izc",link:"AlertsPage_link__VK0R7",stopBtn:"AlertsPage_stopBtn__J2o1J",goBtn:"AlertsPage_goBtn__SGJ0k",startBtn:"AlertsPage_startBtn__+8rI4",doneBtn:"AlertsPage_doneBtn__SHS9V",editBtn:"AlertsPage_editBtn__a6MAw",doneLabel:"AlertsPage_doneLabel__G7cIv"};n(3656);const C=(0,c.ye)(o());const k=function(){const{user:e,privateDispatch:t}=(0,s.d)(),[n,d]=(0,r.useState)(!1),[o,u]=(0,r.useState)(null),[m,_]=(0,r.useState)({text:"",time:"",frequency:"daily",repeat:"noRepeat",end:"23:00",type:"alert",active:!1,done:!1,doneDates:[]}),h=(0,r.useMemo)(()=>[...e.reminders||[]],[e.reminders]),[y,p]=(0,r.useState)([]),f=e=>t((0,i.Oh)(e)),x=()=>{d(!1),u(null),_({text:"",time:"",frequency:"daily",repeat:"noRepeat",end:"23:00",type:"alert",active:!1,done:!1,doneDates:[]})},g=e=>h.forEach(t=>{if(t._id===e){const e=t.doneDates?[...t.doneDates]:[],n=(new Date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-");e.includes(n)||e.push(n),f((0,a.A)((0,a.A)({},t),{},{id:t._id,doneDates:e}))}});return(0,A.jsxs)("div",{className:S.cont,children:[n&&(0,A.jsx)(q,{onClose:x,handleSubmit:e=>{e.text&&e.time?(f((0,a.A)((0,a.A)({},e),{},{id:o||void 0})),x()):alert("Please enter a reminder text and time.")},data:m,handleSet:(e,t)=>_(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t})),editId:o}),(0,A.jsxs)("div",{className:S.leftSideCont,children:[(0,A.jsxs)("div",{className:S.headerBox,children:[(0,A.jsx)("h1",{className:S.title,children:"Calendar"}),(0,A.jsx)("button",{onClick:()=>d(!0),className:S.addBtn,children:"+ Add Reminder"})]}),(0,A.jsx)("div",{className:S.calendarBox,children:(0,A.jsx)(c.Vv,{localizer:C,events:y,startAccessor:"start",endAccessor:"end",className:S.calendar,defaultView:"week",defaultDate:new Date,onRangeChange:e=>{let t,n;Array.isArray(e)?(t=e[0],n=e[e.length-1]):(t=e.start,n=e.end);const a=new Date;a.setHours(0,0,0,0);const r=h.filter(e=>e.active).flatMap(e=>function(e,t,n){if(!e.active)return[];const[a,r]=e.time.split(":").map(Number),[s,i]=e.end?e.end.split(":").map(Number):[a+1,r],l=[],c=e.doneDates||[],d=new Date(t);for(;d<=n;){const t=d.getDay(),n=d.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-");if(c.includes(n))d.setDate(d.getDate()+1);else{if("daily"===e.frequency){const t=new Date(d);t.setHours(a,r,0,0);const n=new Date(d);n.setHours(s,i,0,0),l.push({id:"".concat(e._id,"-").concat(+t),title:e.text,start:t,end:n})}if(Array.isArray(e.frequency)){const n={Su:0,Mo:1,Tu:2,We:3,Th:4,Fr:5,Sa:6};e.frequency.forEach(c=>{if(n[c]===t){const t=new Date(d);t.setHours(a,r,0,0);const n=new Date(d);n.setHours(s,i,0,0),l.push({id:"".concat(e._id,"-").concat(c,"-").concat(+t),title:e.text,start:t,end:n})}})}if("string"===typeof e.frequency&&e.frequency.includes("monthly")){const t=parseInt(e.frequency,10);if(d.getDate()===t){const t=new Date(d);t.setHours(a,r,0,0);const n=new Date(d);n.setHours(s,i,0,0),l.push({id:"".concat(e._id,"-m-").concat(+t),title:e.text,start:t,end:n})}}if(/^\d{4}-\d{2}-\d{2}$/.test(e.frequency)){const[t,n,c]=e.frequency.split("-").map(Number);if(d.getFullYear()===t&&d.getMonth()===n-1&&d.getDate()===c){const d=new Date(t,n-1,c,a,r),o=new Date(t,n-1,c,s,i);l.push({id:e._id,title:e.text,start:d,end:o})}}d.setDate(d.getDate()+1)}}return l}(e,t,n)).filter(e=>e.start>=a);p(r)}})})]}),(0,A.jsxs)("div",{className:S.rightSideCont,children:[(0,A.jsx)("h1",{className:(0,D.A)(S.title,S.rightSideTitle),children:"Reminders"}),(0,A.jsx)("ul",{className:S.remindersList,children:h.map(e=>{var n;const r=(new Date).toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-"),s=null===(n=e.doneDates)||void 0===n?void 0:n.includes(r);return!s&&(0,A.jsxs)("li",{className:S.reminderItem,children:["alert"===e.type&&(0,A.jsx)("button",{type:"button",className:S.closeBtn,onClick:()=>{return n=e._id,t((0,i.sV)({id:n}));var n},children:"x"}),(0,A.jsxs)("div",{className:S.reminderItemDetailsCont,children:[(0,A.jsxs)("span",{className:S.text,children:[e.text," :"]}),(0,A.jsxs)("div",{className:S.timeCont,children:[(0,A.jsx)("span",{className:S.time,children:e.time}),"/",(0,A.jsx)("span",{className:S.repeat,children:Array.isArray(e.frequency)?e.frequency.join(","):e.frequency}),"noRepeat"!==e.repeat&&(0,A.jsxs)("span",{className:S.repeat,children:["/",e.repeat]})]})]}),(0,A.jsxs)("div",{className:S.actions,children:[(0,A.jsxs)("div",{className:S.insideActions,children:[(0,A.jsx)("button",{className:(0,D.A)(e.active?S.stopBtn:S.startBtn),onClick:()=>{return e.active?(t=e._id,h.forEach(e=>e._id===t&&f((0,a.A)((0,a.A)({},e),{},{id:e._id,active:!1})))):(e=>h.forEach(t=>t._id===e&&f((0,a.A)((0,a.A)({},t),{},{id:t._id,active:!0}))))(e._id);var t},children:e.active?"Stop":"Start"}),e.link&&e.active&&!s&&(0,A.jsx)(l.N_,{className:S.link,to:e.link,children:(0,A.jsx)("button",{className:S.goBtn,onClick:()=>{return t=e._id,h.forEach(e=>e._id===t?g(t):null);var t},children:"Go"})})]}),(0,A.jsxs)("div",{className:S.insideActions,children:[e.active&&(0,A.jsx)("button",{className:S.doneBtn,onClick:()=>g(e._id),children:"Done"}),(0,A.jsx)("button",{className:S.editBtn,onClick:()=>{d(!0),_((0,a.A)((0,a.A)({},e),{},{doneDates:e.doneDates||[]})),u(e._id)},children:"Edit"})]})]})]},"alerts-".concat(e._id))})})]})]})}}}]);
//# sourceMappingURL=521.256841da.chunk.js.map