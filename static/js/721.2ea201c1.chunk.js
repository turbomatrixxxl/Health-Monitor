"use strict";(self.webpackChunkhealth_monitor=self.webpackChunkhealth_monitor||[]).push([[721],{8772:(e,t,o)=>{function s(e){let t;t=e<14?[9,11]:e<=17?[8,10]:e<=64?[7,9]:[7,8],"high"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"moderate")&&(t=[t[0]+.5,t[1]+1]);const o=t[0];return(t[1]+o)/2}o.d(t,{A:()=>s})},20379:(e,t,o)=>{function s(e,t,o,s,n,a){const i=Number(String(e).trim()),l=Number(String(t).trim()),r=Number(String(s).trim()),d=Number(String(n).trim()),c=String(o||"").trim().toUpperCase(),u=String(a||"").trim().toUpperCase();if([i,l,r,d].some(Number.isNaN))return 0;let p=i%12;"PM"===c&&(p+=12);let m=r%12;"PM"===u&&(m+=12);let h=60*m+d-(60*p+l);h<0&&(h+=1440);return parseFloat((h/60).toFixed(1))}o.d(t,{A:()=>s})},25480:(e,t,o)=>{function s(e,t){if(!e)return 0;const o=Math.round(70+.3*(e-30)),s=Math.round(o-10),n=Math.round(o+10),a=Math.round(110+.5*e),i=Math.round(a-10),l=Math.round(a+10),r=Math.round(70+.2*e);let d=o,c=s,u=n,p=a,m=i,h=l,x=r,v=Math.round(r-5),g=Math.round(r+5);return t&&(t>80?(d+=2,c+=2,u+=2,p+=3,m+=3,h+=3,x+=2,v+=2,g+=2):t<60&&(d-=2,c-=2,u-=2,p-=3,m-=3,h-=3,x-=2,v-=2,g-=2)),{heartRate:d,heartRateMin:c,heartRateMax:u,systolic:p,systolicMin:m,systolicMax:h,diastolic:x,diastolicMin:v,diastolicMax:g}}o.d(t,{A:()=>s})},29686:(e,t,o)=>{function s(e,t,o,s){let n;n=e<30?1.2:e<50?1.1:1;let a,i=6e3+20*(s-150),l=o-t;a=0===l?0:l<0?200*Math.abs(l):150*-l;let r=e&&t&&o&s?Math.round((i+a)*n):0;return r<4e3&&(r=4e3),r>15e3&&(r=15e3),r}o.d(t,{A:()=>s})},32721:(e,t,o)=>{o.r(t),o.d(t,{default:()=>M});var s=o(89379),n=o(65043),a=o(39657),i=o(73216),l=o(91036),r=o(19095),d=o(72952),c=o(29686),u=o(8772),p=o(25480);var m=o(20379),h=o(6396),x=o(64857);function v(e){const t=new h.Ay;t.setFontSize(16),t.text("Health Report for ".concat(e.name),14,20),t.setFontSize(12);const o=e.from===e.till?"Date: ".concat(new Date(e.from).toDateString()):"Period: ".concat(new Date(e.from).toDateString()," - ").concat(new Date(e.till).toDateString());t.text(o,14,30);let s=40;if(t.text("Based on your personal info, your daily recommended values are:",14,s),s+=8,t.text("Calories: ".concat(e.caloriesRecommended),14,s),s+=6,t.text("Steps: ".concat(e.stepsRecommended),14,s),s+=6,t.text("Sleep: ".concat(e.sleepRecommended,"h"),14,s),s+=6,t.text("Pulse: ".concat(e.pulseRecommended," (Range: ").concat(e.heartRateMin," - ").concat(e.heartRateMax,")"),14,s),s+=6,t.text("Blood Pressure: ".concat(e.systolicRecommended,"/").concat(e.diastolicRecommended," (Sys ").concat(e.systolicMin,"-").concat(e.systolicMax,", Dia ").concat(e.diastolicMin,"-").concat(e.diastolicMax,")"),14,s),s+=12,!e.dates||0===e.dates.length)return t.setTextColor(200,0,0),t.text("No records for this period",14,s),t;const n=e.dates.map(t=>{const o=new Date(t.date).toDateString();let s="No records";t.calories>0&&(s=t.calories<.6*e.caloriesRecommended||t.calories>e.caloriesRecommended?"".concat(t.calories," (!)"):"".concat(t.calories," (OK)"));let n="No records";t.steps>0&&(n=t.steps<.6*e.stepsRecommended?"".concat(t.steps," (!)"):"".concat(t.steps," (OK)"));let a="No records";if(t.sleep>0){const o=Number(t.sleep.toFixed(1));a=o<.6*e.sleepRecommended||o>e.sleepRecommended+1?"".concat(o,"h (!)"):"".concat(o,"h (OK)")}return[o,s,n,a,t.pulse?String(t.pulse):"-",t.systolic&&t.diastolic?"".concat(t.systolic,"/").concat(t.diastolic):"-"]});return(0,x.Ay)(t,{head:[["Date","Calories","Steps","Sleep (h)","Pulse","Blood Pressure"]],body:n,startY:s,styles:{fontSize:10},didParseCell:e=>{if("body"===e.section){const t=String(e.cell.text[0]);t.includes("(!)")?e.cell.styles.textColor=[200,0,0]:t.includes("(OK)")?e.cell.styles.textColor=[0,150,0]:"No records"===t&&(e.cell.styles.textColor=[200,0,0])}}}),t}const g={overlay:"ReportModal_overlay__T2pPa",modal:"ReportModal_modal__EH9QH",downloadBtn:"ReportModal_downloadBtn__x+InD",closeBtn:"ReportModal_closeBtn__4nhEo"};var _=o(70579);const f="(max-width: 767px)";function R(e){let{report:t,onClose:o}=e;const[s,i]=(0,n.useState)(""),r=(0,a.Ub)({query:f}),d=e=>new Date(e).toDateString();(0,n.useEffect)(()=>{if(t){const e=v(t).output("blob"),o=URL.createObjectURL(e);i(o)}},[t]);return t?(0,_.jsx)("div",{className:g.overlay,children:(0,_.jsxs)("div",{className:g.modal,children:[(0,_.jsx)("h2",{children:"PDF Preview"}),s&&(0,_.jsx)("iframe",{src:s,title:"PDF Preview",width:"100%",height:"400px",style:{border:"1px solid #ccc"}}),(0,_.jsxs)("div",{className:g.buttons,children:[(0,_.jsx)("button",{onClick:()=>{const e=v(t),o="".concat(t.name,"_Health_Report-").concat(d(t.from)).concat(t.from!==t.till?"-"+d(t.till):"",".pdf");e.save(o),r&&l.oR.success("Report saved sucsessfully")},className:g.downloadBtn,children:"Download"}),(0,_.jsx)("button",{onClick:o,className:g.closeBtn,children:"Close"})]})]})}):null}var C=o(58387);const y={cont:"ExportReportsPage_cont__koYLr",leftSideCont:"ExportReportsPage_leftSideCont__qCae-",rightSideCont:"ExportReportsPage_rightSideCont__91oX2",title:"ExportReportsPage_title__-wWhT",datesCont:"ExportReportsPage_datesCont__jhSa3",dateCont:"ExportReportsPage_dateCont__V5bD2",date:"ExportReportsPage_date__Nausv",generateBtn:"ExportReportsPage_generateBtn__QUQ5d",rightSideContList:"ExportReportsPage_rightSideContList__jim4J",rightSideContListItem:"ExportReportsPage_rightSideContListItem__H42Vb",rightSideContListItemLeftCont:"ExportReportsPage_rightSideContListItemLeftCont__A6IMK",btnsCont:"ExportReportsPage_btnsCont__CknZe",openReportModalBtn:"ExportReportsPage_openReportModalBtn__PuZNn",rightSideContListItemDatesCont:"ExportReportsPage_rightSideContListItemDatesCont__f1NFj",downloadBtn:"ExportReportsPage_downloadBtn__43Jze",deleteBtn:"ExportReportsPage_deleteBtn__vSrsu",empty:"ExportReportsPage_empty__tASKy"},S="(max-width: 767px)";const M=function(){var e;const t=(0,i.Zp)(),o=(0,a.Ub)({query:S}),{user:h,privateDispatch:x}=(0,r.d)(),g=(null===h||void 0===h?void 0:h.username)||(null===h||void 0===h?void 0:h.name)||"User",f=(null===h||void 0===h?void 0:h.age)||0,M=(null===h||void 0===h?void 0:h.height)||0,N=(null===h||void 0===h?void 0:h.weight)||0,b=(null===h||void 0===h?void 0:h.desiredWeight)||0,j=(null===h||void 0===h?void 0:h.bloodType)||0,D=f>0||M>0||N>0||b>0||j>0,P=null===h||void 0===h||null===(e=h.dietaryInfo)||void 0===e?void 0:e.dailyCalorieIntake,w=(0,c.A)(f,N,b,M),E=(0,u.A)(f),B=(0,p.A)(f,N),{heartRate:A,systolic:L,diastolic:I,heartRateMin:k,heartRateMax:H,systolicMin:F,systolicMax:T,diastolicMin:U,diastolicMax:O}=B,K=e=>new Date(e).toISOString().split("T")[0],z=(0,n.useMemo)(()=>(null===h||void 0===h?void 0:h.reports)||[],[null===h||void 0===h?void 0:h.reports]),[G,Z]=(0,n.useState)([]);(0,n.useEffect)(()=>{const e=[...z].sort((e,t)=>new Date(t.from)-new Date(e.from));Z([...e])},[Z,z]);const q=new Date,Q=K(q),[W,Y]=(0,n.useState)(Q),[J,V]=(0,n.useState)(Q),[X,$]=(0,n.useState)({from:W,till:J,name:g,age:f,height:M,weight:N,desiredWeight:b,bloodType:j,caloriesRecommended:P,stepsRecommended:w,sleepRecommended:E,systolicRecommended:L,diastolicRecommended:I,pulseRecommended:A,heartRateMin:k,heartRateMax:H,systolicMin:F,systolicMax:T,diastolicMin:U,diastolicMax:O,dates:[]});(0,n.useEffect)(()=>{$(e=>(0,s.A)((0,s.A)({},e),{},{from:W,till:J}))},[W,J]);const ee=(0,n.useMemo)(()=>function(e,t){const o=[],s=e=>new Date(e).toISOString().split("T")[0],n=new Date(e);n.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const i=a-n,l=Math.ceil(i/864e5);for(let r=1;r<=l+1;r++){const e=new Date(n);e.setDate(n.getDate()+r),o.push(s(e))}return o}(W,J),[W,J]);(0,n.useEffect)(()=>{if(!h)return;const e=ee.map(e=>{var t,o;const s=((null===h||void 0===h?void 0:h.consumedProducts)||[]).filter(t=>K(null===t||void 0===t?void 0:t.date)===K(e)),n=s.reduce((e,t)=>0===s.length?0:e+=t.calories,0),a=((null===h||void 0===h?void 0:h.steps)||[]).find(t=>K(t.date)===K(e)),i=a?null===a||void 0===a||null===(t=a.interval)||void 0===t?void 0:t.reduce((e,t)=>e+=t.steps,0):0,l=((null===h||void 0===h?void 0:h.sleep)||[]).find(t=>K(t.date)===K(e)),r=l?null===(o=l.interval)||void 0===o?void 0:o.reduce((e,t)=>e+=(0,m.A)(t.fromHour,t.fromMinute,t.fromAmPm,t.tillHour,t.tillMinute,t.tillAmPm),0):0,d=((null===h||void 0===h?void 0:h.heart)||[]).find(t=>K(t.date)===K(e)),c=d?{pulse:null===d||void 0===d?void 0:d.pulse,systolic:null===d||void 0===d?void 0:d.systolic,diastolic:null===d||void 0===d?void 0:d.diastolic}:0;return n>0||i>0||r>0||c>0?{date:e,calories:n,steps:i,sleep:r,systolic:c.systolic||0,diastolic:c.diastolic||0,pulse:c.pulse||0}:null}).filter(e=>null!==e);$(t=>(0,s.A)((0,s.A)({},t),{},{dates:e}))},[ee,h]);const te=e=>new Date(e).toDateString(),[oe,se]=(0,n.useState)(null);return(0,_.jsxs)("div",{className:y.cont,children:[(0,_.jsxs)("div",{className:y.leftSideCont,children:[(0,_.jsx)("h1",{className:y.title,children:"Exports & Reports"}),(0,_.jsxs)("div",{className:y.datesCont,children:[(0,_.jsxs)("div",{className:y.dateCont,children:[(0,_.jsx)("p",{className:y.dateTitle,children:"Start date"}),(0,_.jsx)("input",{onChange:e=>Y(e.target.value),value:W,className:y.date,max:Q,type:"date"})]}),(0,_.jsxs)("div",{className:y.dateCont,children:[(0,_.jsx)("p",{className:y.dateTitle,children:"End date"}),(0,_.jsx)("input",{onChange:e=>V(e.target.value),value:J,className:y.date,min:W,max:Q,type:"date"})]})]}),D?(0,_.jsx)("button",{onClick:function(){x((0,d.dL)({report:(0,s.A)({},X)})),Y(Q),V(Q)},className:y.generateBtn,type:"button",children:"Generate report"}):(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",background:"aliceblue",border:"1px solid var(--Gray-5)",borderRadius:"5px",padding:"10px"},children:[(0,_.jsx)("p",{style:{display:"flex",textAlign:"center",color:"red"},children:"It seems that you did not set up your personal info. Please Go:"}),(0,_.jsx)("button",{onClick:()=>t("/"),className:y.generateBtn,type:"button",children:"Diet Calculator"})]})]}),(0,_.jsxs)("div",{className:y.rightSideCont,children:[(0,_.jsx)("h1",{className:y.title,children:"Generated Reports..."}),(0,_.jsx)("ul",{className:y.rightSideContList,children:G.length>0?G.map(e=>(0,_.jsxs)("li",{className:y.rightSideContListItem,children:[(0,_.jsxs)("div",{className:y.rightSideContListItemLeftCont,children:[(0,_.jsxs)("div",{className:y.btnsCont,children:[(0,_.jsx)("button",{onClick:()=>(e=>{se(e)})(e),type:"button",className:y.openReportModalBtn,children:"PDF Report"}),(0,_.jsx)("button",{onClick:()=>{return t=e._id,void x((0,d.Z5)({id:t}));var t},type:"button",className:(0,C.A)(y.openReportModalBtn,y.deleteBtn),children:"Delete"})]}),(0,_.jsxs)("div",{className:y.rightSideContListItemDatesCont,children:[(0,_.jsx)("span",{children:te(e.from)}),e.from!==e.till&&(0,_.jsxs)("span",{children:["-",te(e.till)]})]})]}),(0,_.jsx)("button",{onClick:()=>(e=>{const t=v(e),s="".concat(e.name,"_Health_Report-").concat(te(e.from)).concat(e.from!==e.till?"-"+te(e.till):"",".pdf");t.save(s),o&&l.oR.success("Report saved sucsessfully")})(e),type:"button",className:y.downloadBtn,children:"Download"})]},"report-".concat(e._id))):(0,_.jsx)("li",{className:(0,C.A)(y.rightSideContListItem,y.empty),children:"No Reports Yet"})}),oe&&(0,_.jsx)(R,{report:oe,onClose:()=>{se(null)}})]})]})}}}]);
//# sourceMappingURL=721.2ea201c1.chunk.js.map