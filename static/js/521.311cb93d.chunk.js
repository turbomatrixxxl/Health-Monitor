"use strict";(self.webpackChunkhealth_monitor=self.webpackChunkhealth_monitor||[]).push([[521],{1695:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(9379),r=n(5043),s=n(9095),i=n(2952),l=n(5475);function c(e){return["Su","Mo","Tu","We","Th","Fr","Sa"][e]}var d=n(5582),o=n(3797),u=n.n(o);const m="AlertForm_formModalCont__n1AHS",_="AlertForm_form__WOPSZ",y="AlertForm_close__6XhrF",h="AlertForm_inputGroup__C-9ve",p="AlertForm_weekly__FbPlI",g="AlertForm_checkboxLabel__V4eiP",f="AlertForm_smallBtn__YJ5YK",v="AlertForm_buttonGroup__C9g8J",x="AlertForm_saveBtn__nemPP",A="AlertForm_cancelBtn__+GW3d";var j=n(579);const b=["Mo","Tu","We","Th","Fr","Sa","Su"],N=new Date,S="".concat(N.getFullYear(),"-").concat(String(N.getMonth()+1).padStart(2,"0"),"-").concat(String(N.getDate()).padStart(2,"0"));function q(e){let{onClose:t,handleSubmit:n,data:s,editId:i}=e;const l=(0,r.useRef)(),[c,d]=(0,r.useState)(()=>"daily"===s.frequency?"daily":"string"===typeof s.frequency&&s.frequency.includes("monthly")?"monthly":"string"===typeof s.frequency&&/^\d{4}-\d{2}-\d{2}$/.test(s.frequency)?"date":(Array.isArray(s.frequency),"weekly")),[o,u]=(0,r.useState)(Array.isArray(s.frequency)?[...s.frequency]:[]),[N,q]=(0,r.useState)((0,a.A)((0,a.A)({},s),{},{frequency:s.frequency})),[D,C]=(0,r.useState)(S);(0,r.useEffect)(()=>{document.body.style.overflow="hidden";const e=e=>{"Escape"===e.key&&t()};return document.addEventListener("keydown",e),()=>{document.body.style.overflow="auto",document.removeEventListener("keydown",e)}},[t]),(0,r.useEffect)(()=>{Array.isArray(s.frequency)&&u([...s.frequency])},[s.frequency]);const k=(e,t)=>{q(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t}))},P="alert"===N.type||"metrix"===N.type;return(0,j.jsx)("div",{ref:l,onClick:e=>{e.currentTarget===e.target&&t()},className:m,children:(0,j.jsxs)("form",{className:_,onSubmit:e=>{let t;e.preventDefault(),t="daily"===c?"daily":"weekly"===c?o:"monthly"===c?N.frequency:"date"===c?D:N.frequency;const r=(0,a.A)((0,a.A)({},N),{},{frequency:t});n(r)},children:[(0,j.jsx)("button",{className:y,onClick:t,type:"button",children:"x"}),P&&(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Reminder Text"}),(0,j.jsx)("input",{type:"text",placeholder:"Enter reminder",value:N.text,onChange:e=>k("text",e.target.value),required:!0})]}),(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Time"}),(0,j.jsx)("input",{type:"time",value:N.time,onChange:e=>k("time",e.target.value),required:!0})]}),P&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Frequency"}),(0,j.jsxs)("select",{value:c,onChange:e=>{d(e.target.value),"daily"===e.target.value&&k("frequency","daily"),"weekly"===e.target.value&&k("frequency",[])},children:[(0,j.jsx)("option",{value:"daily",children:"Daily"}),(0,j.jsx)("option",{value:"weekly",children:"Weekly (choose days)"}),(0,j.jsx)("option",{value:"monthly",children:"Monthly (choose day)"}),(0,j.jsx)("option",{value:"date",children:"Specific Date"})]})]}),"weekly"===c&&(0,j.jsxs)("div",{className:p,children:[b.map(e=>(0,j.jsxs)("label",{className:g,children:[(0,j.jsx)("input",{type:"checkbox",checked:o.includes(e),onChange:()=>(e=>{let t=o.includes(e)?o.filter(t=>t!==e):[...o,e];7===t.length?(d("daily"),u([]),k("frequency","daily")):(u(t),k("frequency",t))})(e)}),e]},e)),(0,j.jsx)("button",{type:"button",className:f,onClick:()=>{d("daily"),u([]),k("frequency","daily")},children:"All"})]}),"monthly"===c&&(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Day of Month"}),(0,j.jsx)("input",{type:"number",min:1,max:31,step:1,value:parseInt(N.frequency)||"",onChange:e=>{return t=parseInt(e.target.value),k("frequency","".concat(t," monthly"));var t}})]}),"date"===c&&(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Specific Date"}),(0,j.jsx)("input",{style:{color:"blue",fontWeight:"bold"},type:"date",min:S,value:/^\d{4}-\d{2}-\d{2}$/.test(N.frequency)?N.frequency:D,onChange:e=>{var t;t=e.target.value,k("frequency",t),C(e.target.value)}})]})]}),(0,j.jsxs)("div",{className:h,children:[(0,j.jsx)("label",{children:"Repeat Interval (hours)"}),(0,j.jsx)("input",{type:"number",min:1,max:12,step:1,value:"noRepeat"===N.repeat?"":parseInt(N.repeat)||"",onChange:e=>{const t=parseInt(e.target.value);isNaN(t)||t<1?k("repeat","noRepeat"):k("repeat",1===t?"1 hour":"".concat(t," hours"))},placeholder:"No Repeat"})]}),(0,j.jsxs)("div",{className:v,children:[(0,j.jsx)("button",{type:"submit",className:x,children:i?"Update Reminder":"Add Reminder"}),(0,j.jsx)("button",{type:"button",onClick:t,className:A,children:"Cancel"})]})]})})}var D=n(8387);const C={cont:"AlertsPage_cont__Bn-of",leftSideCont:"AlertsPage_leftSideCont__uvpyK",rightSideCont:"AlertsPage_rightSideCont__HCF89",title:"AlertsPage_title__vqj0-",rightSideTitle:"AlertsPage_rightSideTitle__uQTtz",headerBox:"AlertsPage_headerBox__3iOMH",addBtn:"AlertsPage_addBtn__b3wO3",main:"AlertsPage_main__KHw-R",calendarBox:"AlertsPage_calendarBox__iSP3z",calendar:"AlertsPage_calendar__vOV+q","rbc-today":"AlertsPage_rbc-today__P2l6q","rbc-time-slot":"AlertsPage_rbc-time-slot__k-Hoo","rbc-event":"AlertsPage_rbc-event__7F-kq",remindersList:"AlertsPage_remindersList__BaT+d",reminderItem:"AlertsPage_reminderItem__bQ515",closeBtn:"AlertsPage_closeBtn__p7Nz7",reminderItemDetailsCont:"AlertsPage_reminderItemDetailsCont__cSW7q",actions:"AlertsPage_actions__ExvCf",insideActions:"AlertsPage_insideActions__J7izc",link:"AlertsPage_link__VK0R7",stopBtn:"AlertsPage_stopBtn__J2o1J",goBtn:"AlertsPage_goBtn__SGJ0k",startBtn:"AlertsPage_startBtn__+8rI4",doneBtn:"AlertsPage_doneBtn__SHS9V",editBtn:"AlertsPage_editBtn__a6MAw",doneLabel:"AlertsPage_doneLabel__G7cIv"};n(3656);const k=(0,d.ye)(u());const P=function(){const{user:e,privateDispatch:t}=(0,s.d)(),[n,o]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),[_,y]=(0,r.useState)({text:"",time:"",frequency:"daily",repeat:"noRepeat",end:"23:00",type:"alert",active:!1,doneDates:[]}),h=(0,r.useMemo)(()=>[...e.reminders||[]],[e.reminders]),[p,g]=(0,r.useState)([]),f=e=>t((0,i.Oh)(e)),v=()=>{o(!1),m(null),y({text:"",time:"",frequency:"daily",repeat:"noRepeat",end:"23:00",type:"alert",active:!1,doneDates:[]})},x=e=>h.forEach(t=>{if(t._id===e){const e=t.doneDates?[...t.doneDates]:[],n=new Date,r=n.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-")+" ".concat(String(n.getHours()).padStart(2,"0"),":").concat(String(n.getMinutes()).padStart(2,"0"));e.includes(r)||e.push(r),f((0,a.A)((0,a.A)({},t),{},{id:t._id,doneDates:e}))}});return(0,r.useEffect)(()=>{const e=setInterval(()=>{g(e=>[...e]),y(e=>(0,a.A)({},e))},36e5);return()=>clearInterval(e)},[]),(0,j.jsxs)("div",{className:C.cont,children:[n&&(0,j.jsx)(q,{onClose:v,handleSubmit:e=>{e.text&&e.time?(f((0,a.A)((0,a.A)({},e),{},{id:u||void 0})),v()):alert("Please enter a reminder text and time.")},data:_,handleSet:(e,t)=>y(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t})),editId:u}),(0,j.jsxs)("div",{className:C.leftSideCont,children:[(0,j.jsxs)("div",{className:C.headerBox,children:[(0,j.jsx)("h1",{className:C.title,children:"Calendar"}),(0,j.jsx)("button",{onClick:()=>o(!0),className:C.addBtn,children:"+ Add Reminder"})]}),(0,j.jsx)("div",{className:C.calendarBox,children:(0,j.jsx)(d.Vv,{localizer:k,events:p,startAccessor:"start",endAccessor:"end",className:C.calendar,defaultView:"week",defaultDate:new Date,onRangeChange:e=>{let t,n;Array.isArray(e)?(t=e[0],n=e[e.length-1]):(t=e.start,n=e.end);const a=new Date;a.setHours(0,0,0,0);const r=h.filter(e=>e.active).flatMap(e=>function(e,t,n){if(!e.active)return[];const[a,r]=e.time.split(":").map(Number),[s,i]=e.end?e.end.split(":").map(Number):[a+1,r],l=[],d=e.doneDates||[];let o=0;"string"===typeof e.repeat&&"noRepeat"!==e.repeat&&(o=parseInt(e.repeat,10)),(isNaN(o)||o<1)&&(o=0);const u=new Date;u.setHours(0,0,0,0);const m=new Date(t);for(;m<=n;){const t=m.getDay(),n=m.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-");if(m<u){m.setDate(m.getDate()+1);continue}const _=()=>{const t=new Date(m);t.setHours(a,r,0,0);const n=new Date(m);if(n.setHours(s,i,0,0),o>0){let a=new Date(t);for(;a<n;){const t=new Date(a);t.setMinutes(t.getMinutes()+1),l.push({id:"".concat(e._id,"-").concat(+a),title:e.text,start:new Date(a),end:new Date(t)}),a.setHours(a.getHours()+o)}}else l.push({id:"".concat(e._id,"-").concat(+t),title:e.text,start:t,end:n})};if("daily"!==e.frequency||d.includes(n)||_(),Array.isArray(e.frequency)&&e.frequency.includes(c(t))&&(d.includes(n)||_()),"string"===typeof e.frequency&&e.frequency.includes("monthly")){const t=parseInt(e.frequency,10);m.getDate()!==t||d.includes(n)||_()}if(/^\d{4}-\d{2}-\d{2}$/.test(e.frequency)){const[t,a,r]=e.frequency.split("-").map(Number);m.getFullYear()!==t||m.getMonth()!==a-1||m.getDate()!==r||d.includes(n)||_()}m.setDate(m.getDate()+1)}return l}(e,t,n)).filter(e=>e.start>=a);g(r)}})})]}),(0,j.jsxs)("div",{className:C.rightSideCont,children:[(0,j.jsx)("h1",{className:(0,D.A)(C.title,C.rightSideTitle),children:"Reminders"}),(0,j.jsx)("ul",{className:C.remindersList,children:h.map(e=>{var n;const r=new Date,s=r.toLocaleDateString("ro-RO",{year:"numeric",month:"2-digit",day:"2-digit"}).split(".").reverse().join("-")+" ".concat(String(r.getHours()).padStart(2,"0"),":").concat(String(r.getMinutes()).padStart(2,"0")),c=null===(n=e.doneDates)||void 0===n?void 0:n.some(e=>e.split(" ")[0]===s.split(" ")[0]);return!c&&(0,j.jsxs)("li",{className:C.reminderItem,children:["alert"===e.type&&(0,j.jsx)("button",{type:"button",className:C.closeBtn,onClick:()=>{return n=e._id,t((0,i.sV)({id:n}));var n},children:"x"}),(0,j.jsxs)("div",{className:C.reminderItemDetailsCont,children:[(0,j.jsxs)("span",{className:C.text,children:[e.text," :"]}),(0,j.jsxs)("div",{className:C.timeCont,children:[(0,j.jsx)("span",{className:C.time,children:e.time}),"/",(0,j.jsx)("span",{className:C.repeat,children:Array.isArray(e.frequency)?e.frequency.join(","):e.frequency}),"noRepeat"!==e.repeat&&(0,j.jsxs)("span",{className:C.repeat,children:["/",e.repeat]})]})]}),(0,j.jsxs)("div",{className:C.actions,children:[(0,j.jsxs)("div",{className:C.insideActions,children:[(0,j.jsx)("button",{className:(0,D.A)(e.active?C.stopBtn:C.startBtn),onClick:()=>{return e.active?(t=e._id,h.forEach(e=>e._id===t&&f((0,a.A)((0,a.A)({},e),{},{id:e._id,active:!1})))):(e=>h.forEach(t=>t._id===e&&f((0,a.A)((0,a.A)({},t),{},{id:t._id,active:!0}))))(e._id);var t},children:e.active?"Stop":"Start"}),e.link&&e.active&&!c&&(0,j.jsx)(l.N_,{className:C.link,to:e.link,children:(0,j.jsx)("button",{className:C.goBtn,onClick:()=>{return t=e._id,h.forEach(e=>e._id===t?x(t):null);var t},children:"Go"})})]}),(0,j.jsxs)("div",{className:C.insideActions,children:[e.active&&(0,j.jsx)("button",{className:C.doneBtn,onClick:()=>x(e._id),children:"Done"}),(0,j.jsx)("button",{className:C.editBtn,onClick:()=>{o(!0),y((0,a.A)((0,a.A)({},e),{},{doneDates:e.doneDates||[]})),m(e._id)},children:"Edit"})]})]})]},"alerts-".concat(e._id))})})]})]})}}}]);
//# sourceMappingURL=521.311cb93d.chunk.js.map